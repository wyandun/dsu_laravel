# Sistema de Registro de Actividades Diarias - Laravel

Un sistema completo para el registro y gesti√≥n de actividades diarias desarrollado en Laravel 12 con integraci√≥n a Active Directory.

## Caracter√≠sticas

### üöÄ Funcionalidades Principales

- **Sistema de Autenticaci√≥n**: Integraci√≥n con Active Directory (AD)
- **Estructura Jer√°rquica**:
  - **Coordinaci√≥n de TICS** (extensible para m√°s coordinaciones)
  - **4 Direcciones**: Seguridad, Infraestructura, Desarrollo de Soluciones, Gesti√≥n de Servicios Inform√°ticos
- **Tres Tipos de Usuario**:
  - **Empleado**: Gestiona sus propias actividades diarias
  - **Director**: Supervisa actividades de empleados de su direcci√≥n espec√≠fica
  - **Coordinador**: Supervisa actividades de todas las direcciones de su coordinaci√≥n
- **Sistema de Reportes Avanzado**: Filtros por fechas, personal, direcci√≥n con exportaci√≥n a Excel
- **Gesti√≥n de Actividades**: CRUD completo con validaciones
- **Restricciones Temporales**: Los empleados solo pueden editar actividades del d√≠a actual
- **Dashboard Diferenciado**: Vistas espec√≠ficas seg√∫n el rol y nivel jer√°rquico
- **Interfaz Moderna**: Dise√±o responsive con Tailwind CSS

### üìã Formulario de Actividades

- **T√≠tulo**: Descripci√≥n de la actividad
- **Tipo**: Quipux, Mantis, CTIT, Correo, Otros
- **N√∫mero de Referencia**: C√≥digo de referencia opcional
- **Tiempo**: Horas dedicadas (formato decimal)
- **Observaciones**: Comentarios adicionales
- **Fecha de Actividad**: Fecha en que se realiz√≥ la actividad

### üìä Sistema de Reportes

- **Filtros Avanzados**: Por empleado, direcci√≥n, fechas, tipo, b√∫squeda de texto
- **Agrupamiento**: Visualizaci√≥n agrupada por direcci√≥n y coordinaci√≥n
- **Exportaci√≥n**: Generaci√≥n de reportes en Excel con todos los filtros aplicados
- **Permisos Jer√°rquicos**: Cada jefe ve solo las actividades bajo su supervisi√≥n
- **Estad√≠sticas**: Total de actividades y horas por per√≠odo

### üè¢ Estructura Organizacional

#### Coordinaci√≥n de TICS
- **Direcciones**:
  - Direcci√≥n de Seguridad
  - Direcci√≥n de Infraestructura
  - Direcci√≥n de Desarrollo de Soluciones
  - Direcci√≥n de Gesti√≥n de Servicios Inform√°ticos

#### Roles y Permisos
- **Coordinador**: Ve todas las actividades de las direcciones de su coordinaci√≥n
- **Director**: Ve solo actividades de empleados de su direcci√≥n espec√≠fica
- **Empleado**: Ve y gestiona solo sus propias actividades

## üõ†Ô∏è Tecnolog√≠as

- **Framework**: Laravel 12
- **Base de Datos**: SQLite (desarrollo)
- **Autenticaci√≥n**: Active Directory (AD) - En desarrollo: Laravel Breeze
- **Frontend**: Blade Templates + Tailwind CSS + Alpine.js
- **Exportaci√≥n**: Laravel Excel (Maatwebsite)
- **Roles**: Sistema personalizado jer√°rquico

## üì¶ Instalaci√≥n

### Requisitos

- Docker & Docker Compose
- Git
- Make (opcional, para comandos simplificados)

### üöÄ Despliegue R√°pido con Docker

#### Desarrollo
```bash
# Clonar el repositorio
git clone <repository-url>
cd dsu_laravel

# Levantar entorno de desarrollo
make dev-up

# O sin Make:
docker-compose -f docker-compose.dev.yml up -d

# Instalar dependencias
make install

# Configurar base de datos
make fresh
```

#### Producci√≥n
```bash
# Clonar el repositorio
git clone <repository-url>
cd dsu_laravel

# Configurar variables de entorno
cp .env.production .env
# Editar .env con configuraciones espec√≠ficas

# Desplegar en producci√≥n
make prod-up

# O usar el script de deploy
./scripts/deploy.sh production
```

### üõ†Ô∏è Comandos Disponibles

#### Desarrollo
- `make dev-up` - Levantar entorno de desarrollo
- `make dev-down` - Detener entorno de desarrollo
- `make dev-shell` - Acceder al contenedor
- `make install` - Instalar dependencias
- `make fresh` - Refrescar base de datos
- `make test` - Ejecutar tests

#### Producci√≥n
- `make prod-up` - Levantar entorno de producci√≥n
- `make prod-down` - Detener entorno de producci√≥n
- `make prod-shell` - Acceder al contenedor
- `make migrate-prod` - Ejecutar migraciones
- `make optimize` - Optimizar aplicaci√≥n
- `make deploy` - Despliegue completo

#### Utilidades
- `make backup-db` - Backup de base de datos
- `make clean` - Limpiar Docker
- `make status` - Estado de contenedores
- `make health` - Verificar salud

### üì± URLs de Acceso

#### Desarrollo
- **Aplicaci√≥n**: http://localhost:8000
- **MailHog** (emails): http://localhost:8025

#### Producci√≥n
- **Aplicaci√≥n**: http://localhost
- **Health Check**: http://localhost/health

### Pasos de Instalaci√≥n Manual

Si prefieres no usar Docker:

1. **Instalar dependencias de PHP**:
   ```bash
   composer install
   ```

2. **Instalar dependencias de Node.js**:
   ```bash
   npm install
   ```

3. **Configurar variables de entorno**:
   ```bash
   cp .env.example .env
   php artisan key:generate
   ```

4. **Ejecutar migraciones y seeders**:
   ```bash
   php artisan migrate --seed
   ```

5. **Compilar assets**:
   ```bash
   npm run build
   ```

6. **Iniciar servidor de desarrollo**:
   ```bash
   php artisan serve
   ```

## ÔøΩ Autenticaci√≥n

### Estado Actual (Desarrollo)
El sistema actualmente usa Laravel Breeze para desarrollo y pruebas. Los usuarios se crean mediante seeders.

### Integraci√≥n Futura con Active Directory

El sistema est√° dise√±ado para integrarse con Active Directory empresarial. Los cambios necesarios incluir√°n:

1. **Configuraci√≥n LDAP**: 
   - Instalaci√≥n del paquete `Adldap2/Adldap2-Laravel`
   - Configuraci√≥n de conexi√≥n al servidor AD

2. **Mapeo de Campos**:
   ```php
   // Ejemplo de mapeo AD -> Laravel
   'name' => $user->getDisplayName(),
   'email' => $user->getEmail(),
   'coordinacion' => $user->getDepartment(),
   'direccion' => $user->getDivision(),
   'tipo_jefe' => determinarTipoJefe($user->getTitle()),
   ```

3. **Middleware de Sincronizaci√≥n**:
   - Sincronizaci√≥n autom√°tica de datos de usuario
   - Actualizaci√≥n de roles basada en grupos AD

4. **Eliminaci√≥n del Registro**:
   - ‚úÖ Ya implementado: Rutas de registro deshabilitadas
   - Los usuarios se autenticar√°n directamente con credenciales AD

## ÔøΩüë• Usuarios de Prueba (Para Desarrollo)

Despu√©s de ejecutar los seeders, tendr√°s acceso a estos usuarios de prueba:

### Coordinador de TICS
- **Email**: coordinador.tics@sistema.com
- **Password**: password
- **Permisos**: Ver actividades de todas las direcciones de TICS

### Directores
- **Seguridad**: director.seguridad@sistema.com
- **Infraestructura**: director.infraestructura@sistema.com
- **Desarrollo**: director.desarrollo@sistema.com
- **Servicios**: director.servicios@sistema.com
- **Password**: password (todos)
- **Permisos**: Ver actividades solo de empleados de su direcci√≥n

### Empleados
- **Emails**: juan.perez@sistema.com, maria.garcia@sistema.com, etc.
- **Password**: password
- **Permisos**: Gestionar solo sus propias actividades

## üéØ Funcionalidades por Rol

### Empleado
- ‚úÖ Crear nuevas actividades
- ‚úÖ Ver sus propias actividades
- ‚úÖ Editar actividades del d√≠a actual
- ‚úÖ Eliminar actividades del d√≠a actual
- ‚ùå Ver actividades de otros empleados

### Director
- ‚úÖ Ver actividades de empleados de su direcci√≥n
- ‚úÖ Generar reportes filtrados de su direcci√≥n
- ‚úÖ Exportar reportes a Excel
- ‚úÖ Crear sus propias actividades
- ‚úÖ Dashboard con estad√≠sticas de su equipo

### Coordinador
- ‚úÖ Ver actividades de todas las direcciones de su coordinaci√≥n
- ‚úÖ Generar reportes completos de la coordinaci√≥n
- ‚úÖ Exportar reportes a Excel con todos los filtros
- ‚úÖ Crear sus propias actividades
- ‚úÖ Dashboard con estad√≠sticas generales de toda la coordinaci√≥n

## üìä Dashboard

### Dashboard del Empleado
- Actividades registradas hoy
- Tiempo total trabajado hoy
- Estad√≠sticas del mes actual
- Actividades recientes

### Dashboard del Director
- Estad√≠sticas de empleados de su direcci√≥n
- Actividades del d√≠a de su equipo
- Tiempo total trabajado por su direcci√≥n
- Resumen de actividades recientes de la direcci√≥n

### Dashboard del Coordinador
- Total de empleados de toda la coordinaci√≥n
- Actividades del d√≠a de todas las direcciones
- Tiempo total trabajado por coordinaci√≥n
- Resumen de actividades por direcci√≥n

## üìà Sistema de Reportes

### Filtros Disponibles
- **Por Empleado**: Selecci√≥n individual (respeta jerarqu√≠a)
- **Por Direcci√≥n**: Filtrado por direcci√≥n espec√≠fica
- **Por Fechas**: Rango de fechas flexible
- **Por Tipo**: Quipux, Mantis, CTIT, Correo, Otros
- **B√∫squeda**: Texto libre en t√≠tulo, referencia, observaciones

### Visualizaci√≥n
- **Agrupamiento por Direcci√≥n**: Las actividades se agrupan por direcci√≥n
- **Estad√≠sticas**: Total de actividades y horas por grupo
- **Paginaci√≥n**: Navegaci√≥n eficiente de resultados
- **Responsive**: Adaptado para m√≥viles y tablets

### Exportaci√≥n
- **Formato Excel**: Exportaci√≥n completa con formato profesional
- **Filtros Aplicados**: El Excel respeta todos los filtros activos
- **Datos Completos**: Incluye fecha, empleado, coordinaci√≥n, direcci√≥n, detalles

## üîê Seguridad

- Middleware de autenticaci√≥n en todas las rutas protegidas
- Validaci√≥n de permisos por rol y jerarqu√≠a
- Filtrado autom√°tico seg√∫n nivel de supervisi√≥n
- Restricciones temporales para edici√≥n (empleados)
- Protecci√≥n CSRF en todos los formularios
- Validaci√≥n tanto en frontend como backend

## üåê API y Rutas

### Rutas Principales
- `/dashboard` - Dashboard principal (diferenciado por rol)
- `/activities` - Listado de actividades
- `/activities/create` - Crear nueva actividad
- `/activities/{id}` - Ver detalle de actividad
- `/activities/{id}/edit` - Editar actividad

### Middleware Aplicado
- `auth` - Autenticaci√≥n requerida
- `verified` - Email verificado
- `role` - Control de acceso por rol

## üé® Dise√±o y UX

- **Responsive Design**: Adaptable a todos los dispositivos
- **Tailwind CSS**: Framework CSS moderno
- **Componentes Blade**: Reutilizaci√≥n de c√≥digo
- **Mensajes de Estado**: Feedback claro al usuario
- **Validaci√≥n en Tiempo Real**: Mejor experiencia de usuario

## üîß Desarrollo

### Estructura del Proyecto
```
app/
‚îú‚îÄ‚îÄ Http/Controllers/
‚îÇ   ‚îú‚îÄ‚îÄ ActivityController.php
‚îÇ   ‚îú‚îÄ‚îÄ DashboardController.php
‚îÇ   ‚îî‚îÄ‚îÄ Auth/
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îú‚îÄ‚îÄ User.php
‚îÇ   ‚îî‚îÄ‚îÄ Activity.php
‚îî‚îÄ‚îÄ Http/Middleware/
    ‚îî‚îÄ‚îÄ RoleMiddleware.php

resources/views/
‚îú‚îÄ‚îÄ activities/
‚îú‚îÄ‚îÄ dashboard/
‚îú‚îÄ‚îÄ auth/
‚îî‚îÄ‚îÄ layouts/

database/
‚îú‚îÄ‚îÄ migrations/
‚îî‚îÄ‚îÄ seeders/
```

### Comandos √ötiles

```bash
# Crear nueva migraci√≥n
php artisan make:migration nombre_migracion

# Crear nuevo controlador
php artisan make:controller NombreController

# Ejecutar tests
php artisan test

# Limpiar cache
php artisan cache:clear
php artisan config:clear
php artisan view:clear
```

## üìù Pr√≥ximas Mejoras

- [ ] Exportaci√≥n de reportes en PDF/Excel
- [ ] Filtros avanzados de b√∫squeda
- [ ] Notificaciones en tiempo real
- [ ] API REST completa
- [ ] Sistema de comentarios en actividades
- [ ] Gesti√≥n de equipos y departamentos

## ü§ù Contribuci√≥n

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

## üë®‚Äçüíª Autor

Desarrollado como parte del sistema de gesti√≥n de actividades diarias.

---

**¬°El sistema est√° listo para usarse! üöÄ**

Accede a `http://localhost:8000` para comenzar a utilizarlo.
